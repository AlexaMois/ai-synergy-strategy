import { useIntersectionObserver } from "@/hooks/use-intersection-observer";
import { Button } from "@/components/ui/button";
import { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from "@/components/ui/accordion";
import { Search, Layers, ShieldCheck } from "lucide-react";

const ServicesDetailed = () => {
  const { ref, isVisible } = useIntersectionObserver({ threshold: 0.1 });

  const services = [
    {
      number: "01",
      icon: Search,
      title: "Диагностика",
      subtitle: "Анализ ваших процессов и ИТ-ландшафта. Честный разбор где ИИ даст результат за месяц, где нужна подготовка процессов, где он вообще не нужен.",
      sections: [
        {
          heading: "Для кого это",
          content: "CEO, COO, ИТ-директора, которые хотят принимать технологические решения на основе фактов, а не предположений подрядчиков."
        },
        {
          heading: "Какая боль закрывает",
          list: [
            "Сложно понять что именно стоит автоматизировать",
            "Подрядчики предлагают разные решения, каждое «лучшее»",
            "Есть страх вложиться в инструмент, который не принесёт пользы",
            "Люди боятся изменений и не понимают зачем они нужны",
            "Нет единой картины процессов — только гипотезы"
          ]
        },
        {
          heading: "Почему это важно",
          content: "Часто компании внедряют решения, которые технически работают, но не приносят результата для бизнеса. Честный анализ помогает избежать этой ошибки."
        },
        {
          heading: "Как это работает",
          list: [
            "Разбираю цели бизнеса и контекст",
            "Исследую процессы: где теряются время, деньги, контроль",
            "Оцениваю зрелость данных и ИТ-ландшафт",
            "Смотрю что уже есть и что можно усилить без замены",
            "Формирую карту решений: полезные → возможные → лишние"
          ]
        },
        {
          heading: "Что вы получаете",
          list: [
            "Четкий ответ где ИИ даст эффект, а где нет",
            "Список решений, которые можно внедрить в ближайшие 2–6 недель",
            "Процессы которые нужно починить прежде чем автоматизировать",
            "Сценарии по уровню вложений: минимальный / оптимальный / расширенный",
            "Прозрачный прогноз нагрузки на команду",
            "Понимание где простота важнее мощности, а где наоборот"
          ]
        },
        {
          heading: "В чём отличие",
          content: "Я не оцениваю только технологии. Смотрю на смысл задачи, процессы, людей, данные и архитектуру вместе."
        },
        {
          heading: "Реальный пример",
          content: "В одной компании было шесть внедренных автоматизаций — ни одна не использовалась. После диагностики оказалось: решение лежало прямо под руками, просто было неправильно встроено в процесс."
        },
        {
          heading: "Результат",
          content: "Снижение потерь времени на 20–60%. Четкое понимание: где внедрять ИИ, за сколько, за какое время, что чинить прежде чем автоматизировать."
        }
      ],
      pricing: "Стоимость: от 15 000 ₽",
      timeline: "Срок: 7–10 дней",
      cta: "Заказать диагностику →"
    },
    {
      number: "02",
      icon: Layers,
      title: "Архитектура",
      subtitle: "Проектирование AI-решения, которое встраивается в ваш процесс. Выбираем технологии без лишних затрат, определяем интеграцию с CRM, 1С, производственными системами, готовим техническое задание для разработчиков.",
      sections: [
        {
          heading: "Для кого это",
          content: "Для тех, кто хочет внедрять ИИ не «точечно», а как часть управленческой логики. Для компаний, которые знают что внедрять, но не знают как."
        },
        {
          heading: "Какая боль закрывает",
          list: [
            "Решения работают отдельно, не усиливают друг друга",
            "Бизнес сталкивается с перегруженными «коробками» инструментов",
            "Нет ясности что выбрать: какую платформу, какой язык модели, свой сервер или облако",
            "Смета подрядчиков неочевидна и кажется завышена",
            "Каждый инструмент живёт своей жизнью, нет интеграции"
          ]
        },
        {
          heading: "Почему это важно",
          content: "ИИ работает только тогда, когда идёт в связке с процессами. Если логики нет — эффект не появится, даже при дорогих технологиях."
        },
        {
          heading: "Как это работает",
          list: [
            "Формулируем что должно измениться в бизнесе",
            "Строю архитектуру: интеграции, маршруты данных, взаимодействие ролей",
            "Выбираю инструменты без привязки к вендорам (только нужные)",
            "Учитываю требования РФ: где данные, какие контуры, импортозамещение",
            "Проектирую три сценария внедрения: быстрый / оптимальный / фундаментальный",
            "Формирую карту внедрения с шагами, рисками, сроками"
          ]
        },
        {
          heading: "Что вы получаете",
          list: [
            "Ясную обоснованную архитектуру, которую понимают управленцы и ИТ",
            "Три сценария внедрения с разными затратами и сроками",
            "Прозрачные критерии выбора подрядчиков",
            "Конкретные требования к инструментам (а не размытые)",
            "Техническое задание для разработки",
            "Понимание где простота важнее мощности, а где наоборот",
            "Реальный бюджет и сроки разработки"
          ]
        },
        {
          heading: "В чём отличие",
          content: "Я соединяю управленческое мышление и инженерную точность. Смотрю на систему так же, как собственник или CTO."
        },
        {
          heading: "Реальный пример",
          content: "Компания хотела внедрить 14 инструментов. После архитектуры осталось 3 — самые простые и недорогие. Эффект от трёх инструментов оказался в разы выше, чем от первоначального плана."
        },
        {
          heading: "Результат",
          content: "Компании часто сокращают бюджет внедрения ×3–5, сохраняя качество. Понимание что внедрять и в каком порядке."
        }
      ],
      pricing: "Стоимость: от 60 000 ₽",
      timeline: "Срок: 7–10 дней",
      cta: "Заказать архитектуру →"
    },
    {
      number: "03",
      icon: ShieldCheck,
      title: "Сопровождение",
      subtitle: "Контроль разработки и реализации, обучение команды, гарантия результата. Я проверяю что подрядчик делает правильно и что обещанные метрики действительно достигаются.",
      sections: [
        {
          heading: "Для кого это",
          content: "Для компаний, которые хотят снизить риски и не быть заложниками технических подрядчиков. Для тех, кто разочарован предыдущими проектами."
        },
        {
          heading: "Какая боль закрывает",
          list: [
            "Сложно понять адекватна ли смета подрядчика",
            "Внедрения затягиваются и становятся сложнее",
            "Команды боятся ИИ или не понимают что с ним делать",
            "Подрядчики предлагают лишние функции, раздувают проект",
            "Решение сделано, но им никто не пользуется, оно «лежит на полке»"
          ]
        },
        {
          heading: "Почему это важно",
          content: "ИИ — это не только про код. Это про людей, функции, процессы и ответственность. Если одного из этого нет — система не сработает."
        },
        {
          heading: "Как это работает",
          list: [
            "Проверяю сметы, архитектуру, техническое задание",
            "Контролирую ход работ еженедельно и качество разработки",
            "Обучаю сотрудников работать с ИИ простым языком",
            "Помогаю встроить решение в реальные процессы",
            "Оцениваю результат на реальных цифрах и метриках",
            "Гарантирую достижение обещанных результатов"
          ]
        },
        {
          heading: "Что вы получаете",
          list: [
            "Решение которое работает и используется, а не «лежит на полке»",
            "Минимизацию лишних затрат и функций",
            "Управляемый процесс внедрения (еженедельный контроль)",
            "Уверенность что подрядчики делают нужное",
            "Команду которая понимает инструмент и может его развивать",
            "Гарантию достижения метрик"
          ]
        },
        {
          heading: "В чём отличие",
          content: "Я стою на стороне клиента. Моя задача — защитить бизнес, а не оправдать подрядчика."
        },
        {
          heading: "Реальный пример",
          content: "В одной компании подрядчик предложил решение за 2 млн. После экспертизы: половина функций не нужна, а задача решается за 0 ₽ — тем, что уже стоит в системе."
        },
        {
          heading: "Результат",
          content: "Компании сокращают бюджет внедрения на 20–80%. Система работает, результаты достигаются, команда не боится ИИ."
        }
      ],
      pricing: "Стоимость: от 50 000 ₽/месяц",
      timeline: "Срок: 2–3 месяца",
      cta: "Заказать сопровождение →"
    }
  ];

  return (
    <section ref={ref} className="py-10 md:py-16 lg:py-20 bg-card">
      <div className="container mx-auto px-4">
        <div className="max-w-5xl mx-auto">
          <Accordion type="single" collapsible className="space-y-6">
            {services.map((service, serviceIndex) => {
              const Icon = service.icon;
              return (
                <AccordionItem
                  key={service.number}
                  value={service.number}
                  className={`bg-card border border-border rounded-2xl shadow-soft hover:shadow-card transition-shadow duration-200 overflow-hidden ${isVisible ? 'animate-fade-in-up' : 'opacity-0'}`}
                  style={{ animationDelay: `${serviceIndex * 0.15}s` }}
                >
                  <AccordionTrigger className="px-6 py-6 sm:px-8 sm:py-8 hover:no-underline hover:bg-primary/10 transition-colors [&[data-state=open]]:bg-primary/10">
                    <div className="flex items-start gap-4 sm:gap-6 w-full text-left">
                      {/* Number and Icon */}
                      <div className="flex-shrink-0 flex flex-col items-center gap-2">
                        <div className="text-4xl sm:text-5xl font-bold text-primary/30">
                          {service.number}
                        </div>
                        <Icon className="w-8 h-8 sm:w-10 sm:h-10 text-primary" strokeWidth={1.5} />
                      </div>
                      
                      {/* Title and Subtitle */}
                      <div className="flex-1 min-w-0">
                        <h3 className="text-xl sm:text-2xl font-medium text-foreground mb-2 leading-tight">
                          {service.title}
                        </h3>
                        <p className="text-base sm:text-lg text-foreground leading-relaxed">
                          {service.subtitle}
                        </p>
                      </div>
                    </div>
                  </AccordionTrigger>

                  <AccordionContent className="px-6 sm:px-8 pb-8">
                    <div className="space-y-6 pt-6 border-t border-border">
                      {service.sections.map((section, sectionIndex) => (
                        <div key={sectionIndex} className="space-y-2">
                          <h4 className="text-lg font-medium text-foreground">
                            {section.heading}
                          </h4>
                          {section.content && (
                            <p className="text-base text-foreground leading-relaxed whitespace-pre-line">
                              {section.content}
                            </p>
                          )}
                          {section.list && (
                            <ul className="space-y-2 ml-4">
                              {section.list.map((item, itemIndex) => (
                                <li key={itemIndex} className="text-base text-foreground leading-relaxed flex">
                                  <span className="mr-2 text-primary flex-shrink-0">—</span>
                                  <span>{item}</span>
                                </li>
                              ))}
                            </ul>
                          )}
                        </div>
                      ))}

                      {/* Pricing and Timeline */}
                      <div className="pt-4 space-y-2">
                        <p className="text-base font-medium text-foreground">{service.pricing}</p>
                        <p className="text-base text-foreground">{service.timeline}</p>
                      </div>

                      {/* CTA Button */}
                      <div className="pt-4">
                        <Button size="lg" className="w-full sm:w-auto" asChild>
                          <a href="https://calendar.app.google/Zb3NNbpFm3Yh1uA59" target="_blank" rel="noopener noreferrer">
                            {service.cta}
                          </a>
                        </Button>
                      </div>
                    </div>
                  </AccordionContent>
                </AccordionItem>
              );
            })}
          </Accordion>
        </div>
      </div>
    </section>
  );
};

export default ServicesDetailed;
